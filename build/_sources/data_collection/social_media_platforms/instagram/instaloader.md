# Instagram
Data collection from Instagram can be obtained using [`instaloader`](https://instaloader.github.io/).  
Options and arguments for the tool can be found in the [official documentation](https://instaloader.github.io/).


## Installing the tool[^sn1]
```{code-block} bash
:name: c5-23
:caption: Command `[c5.23]`

pip install instaloader
```

:::{dropdown} {octicon}`video;2em` `[c5.23]`
```{eval-rst}
.. asciinema:: 607193

```
:::

## Using the tool[^sn2]

```{code-block} bash
:name: c5-24
:caption: Command `[c5.24]`

instaloader --login [account_collecting] [target] [options]
```

```{code-block} bash
:name: c5-25
:caption: Command `[c5.25]`

instaloader --login [ACCOUNT_COLLECTING] --comments --geotags profile mitpress
```
## Extracting the data

### Extracting and merging data from posts and comments[^sn3]
```{rli} https://github.com/catlism/catlism_scripts/raw/main/s5.09_extract_instaloader_json.py
:name: s5-09
:caption: Script `[s5.09]` [{octicon}`download;1em;sd-text-primary`](https://github.com/catlism/catlism_scripts/raw/main/s5.09_extract_instaloader_json.py)
:linenos: 
:lines: 20-
```

#### How to use script `[s5.09]`{octicon}`repo-template;1em;sd-text-success`
Copy/download the file `s5.09_extract_instaloader_json.py` inside the folder where the data downloaded through `instaloader` (e.g. through `c5.25`) resides; then browse inside the folder through the terminal, e.g.

```{code-block} bash
cd Downloads/instagram_data/
```

At last, run the script from the terminal:

```{code-block} bash
python s5.09_extract_instaloader_json.py
```

### Example of data extracted with `[s5.09]`[^sn4]
```{code-block} xml
:name: e5-11
:caption: Example `[e5.11]` 
:linenos:

<?xml version='1.0' encoding='UTF-8'?>
<text>
  <item id="UNIQUE_ID" type="post" created="UNIX_TIMESTAMP" username="USERNAME" location="LOCATION" likes="NUMBER" comments="NUMBER">
    POST TEXTUAL CONTENT
    <media mediafile="MEDIA_FILENAME.mp4" mediatype="VIDEO_OR_IMAGE" mediadescr="MEDIA_ACCESSIBILITY_CAPTION" media_shortcode="SHORTCODE" media_views="NUMBER" />
  </item>
  <item id="UNIQUE_ID" type="comment" created="UNIX_TIMESTAMP" username="USERNAME" location="LOCATION" likes="NUMBER" comments="NUMBER">COMMENT TEXTUAL CONTENT</item>
</text>
```

## Fix `login error` using a 'session file' for the `--login` option
As per the [official documentation](https://instaloader.github.io/troubleshooting.html#login-error), when using the `--login` option in interactive mode (i.e. inserting username and password in the CLI), `instaloader` may fail with a `login error`. To solve this error it is oftentimes sufficient to use a 'session file', i.e. the Instagram cookies generated by a web browser when logging in into the website from PC.  
Existing 'session file' can automatically be imported into `instaloader` through script [615_import_firefox_session.py](https://raw.githubusercontent.com/instaloader/instaloader/master/docs/codesnippets/615_import_firefox_session.py), which first requires the user to login into Instagram through Firefox (other browsers are not supported!). The following steps (adapted from the [official documentation](https://instaloader.github.io/troubleshooting.html#login-error)) describe the procedure, also exemplified in the [`asciinema`](../../../using_oc.md#asciinema-interactive-videos) video below.

1. Download the script [615_import_firefox_session.py](https://raw.githubusercontent.com/instaloader/instaloader/master/docs/codesnippets/615_import_firefox_session.py) - you may save it in any folder
2. Login to Instagram using Firefox
3. In the CLI, browse to the folder where you downloaded script [615_import_firefox_session.py](https://raw.githubusercontent.com/instaloader/instaloader/master/docs/codesnippets/615_import_firefox_session.py)
4. Execute the script in the CLI, using command `[c0.02]` `python 615_import_firefox_session.py`
5. Using `instaloader` with the `--login` option will automatically make use of the imported 'session file'

```{code-block} bash
:name: c0-02
:caption: Command `[c0.02]`

python 615_import_firefox_session.py
```

:::{dropdown} {octicon}`video;2em` `[c0.02]`
Prior to the execution of command `[c0.02]`, script [615_import_firefox_session.py](https://raw.githubusercontent.com/instaloader/instaloader/master/docs/codesnippets/615_import_firefox_session.py) was downloaded to the folder `instaloader_script` after logging into Instagram using Firefox.  
The username whose details are loaded through the cookie is displayed in the output; in the video this has been replaced with `[REDACTED_USERNAME]`.

```{eval-rst}
.. asciinema:: 607345

```
:::



[^sn1]: `CATLISM, 206`
[^sn2]: `CATLISM, 206; 208`
[^sn3]: `CATLISM, 220-226`
[^sn4]: `CATLISM, 220`