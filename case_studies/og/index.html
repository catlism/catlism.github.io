

<!DOCTYPE html>


<html lang="en" data-theme="dark">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
    <link href="../../_static/logo-16x16.png" sizes="16x16" rel="icon" type="image/png">
    <link href="../../_static/logo-32x32.png" sizes="32x32" rel="icon" type="image/png">
    <link href="../../_static/logo.svg" rel="icon" type="image/svg+xml">
    <title>The communicative modus operandi of online child sexual groomers &#8212; CATLISM | Online Compendium</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "dark";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/asciinema-player_2.6.1.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/asciinema-custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/asciinema-player_2.6.1.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="../../_static/main.js"></script>
    <script src="../../_static/design-tabs.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'case_studies/og/index';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="FAQs" href="../../faq.html" />
    <link rel="prev" title="Analysing the language of far-right groups on Twitter and Facebook" href="../frg/index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="dark">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    <p class="title logo__title">CATLISM | Online Compendium</p>
  
</a></div>
        <div class="sidebar-primary-item">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../on_scripts.html">On scripts and tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../using_oc.html">Using the online compendium</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../from_the_book/index.html">From the book</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../from_the_book/contents_list.html">Reference list for online contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../from_the_book/content_updates.html">Content updates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../from_the_book/preservation_links.html">Preservation copies of online materials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../from_the_book/errata.html">Errata</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../from_the_book/from_pdf.html">Copy-pasting code from the PDF version of the book</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../setup_env/index.html">Setting up the working environment</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../setup_env/conda.html">Using <code class="docutils literal notranslate"><span class="pre">conda</span></code></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../eval_metadata/index.html">Metadata evaluation</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../eval_metadata/facebook/index.html">Facebook metadata</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../eval_metadata/facebook/fb_fbs-posts-metadata.html">Facebook metadata for posts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../eval_metadata/facebook/fb_fbs-profiles-metadata.html">Facebook metadata for profiles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../eval_metadata/facebook/fb_fbs-groups-metadata.html">Facebook metadata for groups</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../eval_metadata/instagram/index.html">Instagram metadata</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../eval_metadata/instagram/ig_instaloader-posts-metadata.html">Instagram metadata for posts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../eval_metadata/instagram/ig_instaloader-comments-metadata.html">Instagram metadata for comments</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../eval_metadata/twitter/index.html">Twitter metadata</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../eval_metadata/twitter/tw_snscrape-metadata.html">Twitter metadata</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../eval_metadata/youtube/index.html">Youtube metadata</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../eval_metadata/youtube/yt_ytdl-videos-metadata.html">Youtube metadata for videos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../eval_metadata/youtube/yt_ytcd-comments-metadata.html">Youtube metadata for comments</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../data_collection/index.html">Data collection</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../data_collection/general_purpose/index.html">General purpose scrapers</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../data_collection/general_purpose/lancsbox.html">#LancsBox</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data_collection/general_purpose/archivebox.html">Archivebox</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data_collection/general_purpose/trafilatura.html">Trafilatura</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data_collection/general_purpose/beautifulsoup.html">BeautifulSoup</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../data_collection/social_media_platforms/index.html">Social Media Platforms</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../data_collection/social_media_platforms/facebook/fbs.html">Facebook</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data_collection/social_media_platforms/instagram/instaloader.html">Instagram</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data_collection/social_media_platforms/twitter/snscrape.html">Twitter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data_collection/social_media_platforms/youtube/yt-dlp_ytcd.html">Youtube</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../data_processing/index.html">Data processing</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../data_processing/dates_time_unix.html">Date, time, and Unix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data_processing/text_normalisation.html">Text normalisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data_processing/pdf_word_images.html">PDF, Word, images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data_processing/language_detection.html">Language detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data_processing/emoticons_emojis.html">Emoticons and emojis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data_processing/hashtags.html">Hashtags (word segmentation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data_processing/other_elements.html">Other elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data_processing/annotations/stanza.html">Annotations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data_processing/vrt_format.html">Verticalised (.vrt) format</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../data_exploration/index.html">Data exploration</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../data_exploration/openrefine/openrefine.html">OpenRefine</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../data_preservation/index.html">Data preservation</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../data_preservation/wayback_machine.html">Wayback Machine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data_preservation/git101.html">Git 101: the basics</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../index.html">Case-studies: CATLISM practical applications</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../cdm/index.html">Analysing crypto-drug market fora</a></li>
<li class="toctree-l2"><a class="reference internal" href="../frg/index.html">Analysing the language of far-right groups on Twitter and Facebook</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">The communicative modus operandi of online child sexual groomers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html"><span class="fa fa-circle-question"></span> FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../acknowledgments.html">Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/case_studies/og/index.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>The communicative modus operandi of online child sexual groomers</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#collecting-the-data-from-perverted-justice">Collecting the data from Perverted Justice</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-the-final-corpus">Creating the final corpus</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-from-the-final-corpus">Sample from the final corpus</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-of-the-interactive-plot-created-for-the-visual-exploration-of-collocations">Example of the interactive plot created for the visual exploration of collocations</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="the-communicative-modus-operandi-of-online-child-sexual-groomers">
<h1>The communicative modus operandi of online child sexual groomers<a class="headerlink" href="#the-communicative-modus-operandi-of-online-child-sexual-groomers" title="Permalink to this heading">#</a></h1>
<span class="sidenote"><sup>1</sup>www.swansea.ac.uk/project-dragon-s/</span><span class="sidenote"><sup>2</sup><code class="docutils literal notranslate"><span class="pre">CATLISM,</span> <span class="pre">350</span></code></span><blockquote>
<div><p>The case study [utilised] in this section is based on the research conducted at Swansea University Department of Applied Linguistics under the supervision of Prof. Nuria Lorenzo-Dus as part of the project ‘Online Grooming Discourse’ funded by EPSRC–CHERISH-DE and NSPCC (Lead Investigator: Prof. Nuria Lorenzo-Dus). In 2021 the project evolved into Project Dragon-S<label for='sidenote-role-1' class='margin-toggle'><span id="id1">
<sup>1</sup></span>

</label><input type='checkbox' id='sidenote-role-1' name='sidenote-role-1' class='margin-toggle'><span class="sidenote d-n"><sup>1</sup>www.swansea.ac.uk/project-dragon-s/</span> (Developing Resistance Against Grooming Online – Spot and Shield). Outputs from the research are published in <span id="id2">[<a class="reference internal" href="../../references.html#id8" title="Lorenzo-Dus, Nuria and Anina Kinzel. ‘So is your mom as cute as you?’: Examining patterns of language use in online sexual grooming of children. Journal of Corpora and Discourse Studies, 2(1):1–30, 2019. doi:10.18573/ jcads.31.">Lorenzo-Dus and Kinzel, 2019</a>]</span> and <span id="id3">[<a class="reference internal" href="../../references.html#id49" title="Nuria Lorenzo-Dus, Anina Kinzel, and Matteo Di Cristofaro. The communicative modus operandi of online child sexual groomers: Recurring patterns in their language use. Journal of Pragmatics, 155:15–27, January 2020. URL: https://www.sciencedirect.com/science/article/pii/S0378216619306162 (visited on 2022-02-09), doi:10.1016/j.pragma.2019.09.010.">Lorenzo-Dus <em>et al.</em>, 2020</a>]</span>, which served as basis for the contents [described].<label for='sidenote-role-2' class='margin-toggle'><span id="id4">
<sup>2</sup></span>

</label><input type='checkbox' id='sidenote-role-2' name='sidenote-role-2' class='margin-toggle'><span class="sidenote d-n"><sup>2</sup><code class="docutils literal notranslate"><span class="pre">CATLISM,</span> <span class="pre">350</span></code></span></p>
</div></blockquote>
<section id="collecting-the-data-from-perverted-justice">
<span class="sidenote"><sup>3</sup><code class="docutils literal notranslate"><span class="pre">CATLISM,</span> <span class="pre">353-357</span></code></span><h2>Collecting the data from <a class="reference external" href="http://perverted-justice.com/">Perverted Justice</a><label for='sidenote-role-3' class='margin-toggle'><span id="id5">
<sup>3</sup></span>

</label><input type='checkbox' id='sidenote-role-3' name='sidenote-role-3' class='margin-toggle'><span class="sidenote d-n"><sup>3</sup><code class="docutils literal notranslate"><span class="pre">CATLISM,</span> <span class="pre">353-357</span></code></span><a class="headerlink" href="#collecting-the-data-from-perverted-justice" title="Permalink to this heading">#</a></h2>
<div class="literal-block-wrapper docutils container" id="s6-05">
<div class="code-block-caption"><span class="caption-text">Script <code class="docutils literal notranslate"><span class="pre">[s6.05]</span></code> <a class="reference external" href="https://github.com/catlism/catlism_scripts/raw/main/s6.05_chatlog-scraper_with-comments.py"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-download sd-text-primary" viewBox="0 0 16 16" aria-hidden="true"><path fill-rule="evenodd" d="M7.47 10.78a.75.75 0 001.06 0l3.75-3.75a.75.75 0 00-1.06-1.06L8.75 8.44V1.75a.75.75 0 00-1.5 0v6.69L4.78 5.97a.75.75 0 00-1.06 1.06l3.75 3.75zM3.75 13a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5z"></path></svg></a> (adapted from <span id="id6">[<a class="reference internal" href="../../references.html#id212" title="Jay Morgan. Jaypmorgan/chatlog-scrapper: archive-doi. July 2022. URL: https://github.com/jaypmorgan/chatlog-scrapper (visited on 2022-08-02), doi:10.5281/zenodo.6896236.">Morgan, 2022</a>]</span>)</span><a class="headerlink" href="#s6-05" title="Permalink to this code">#</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="c1"># Import modules for: regular expressions and for working with local files; List to enforce the type of data collected</span>
<span class="linenos">  2</span><span class="c1"># (this is only required for Python &lt; 3.9), and selected functions from Selenium</span>
<span class="linenos">  3</span><span class="kn">import</span> <span class="nn">re</span>
<span class="linenos">  4</span><span class="kn">import</span> <span class="nn">os</span>
<span class="linenos">  5</span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>
<span class="linenos">  6</span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="linenos">  7</span><span class="kn">from</span> <span class="nn">selenium.webdriver</span> <span class="kn">import</span> <span class="n">Chrome</span>
<span class="linenos">  8</span><span class="kn">from</span> <span class="nn">selenium.webdriver.common.by</span> <span class="kn">import</span> <span class="n">By</span>
<span class="linenos">  9</span><span class="kn">from</span> <span class="nn">selenium.webdriver.chrome.options</span> <span class="kn">import</span> <span class="n">Options</span>
<span class="linenos"> 10</span><span class="kn">from</span> <span class="nn">selenium.common.exceptions</span> <span class="kn">import</span> <span class="n">NoSuchElementException</span>
<span class="linenos"> 11</span>
<span class="linenos"> 12</span><span class="c1"># Define the scraper as a class of objects</span>
<span class="linenos"> 13</span><span class="k">class</span> <span class="nc">ChatLogScraper</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="linenos"> 14</span>    <span class="c1"># Define the first function that sets the initial parameters: the starting URL, the regular expression to match the chatlog contents, as well as further options for Selenium</span>
<span class="linenos"> 15</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos"> 16</span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Init function, defines some class variables.&quot;&quot;&quot;</span>
<span class="linenos"> 17</span>        <span class="bp">self</span><span class="o">.</span><span class="n">home_url</span> <span class="o">=</span> <span class="s2">&quot;http://www.perverted-justice.com/?con=full&quot;</span>
<span class="linenos"> 18</span>
<span class="linenos"> 19</span>        <span class="c1"># Setup and compile the regular expression for later</span>
<span class="linenos"> 20</span>        <span class="n">master_matcher</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;([\s\w\d]+)[:-]?\s(?:\(.*\s(\d+:\d+:\d+\s[AP]M)\))?:?((.*)(\s\d+:\d+\s[AP]M)|(.*))&quot;</span>
<span class="linenos"> 21</span>        <span class="bp">self</span><span class="o">.</span><span class="n">chat_instance</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
<span class="linenos"> 22</span>            <span class="n">master_matcher</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span>
<span class="linenos"> 23</span>        <span class="p">)</span>  <span class="c1"># ignore case may not be necessary</span>
<span class="linenos"> 24</span>
<span class="linenos"> 25</span>        <span class="c1"># Instantiate the firefox driver in headless mode, disable all css, images, etc</span>
<span class="linenos"> 26</span>        <span class="n">here</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
<span class="linenos"> 27</span>        <span class="n">executable</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">here</span><span class="p">,</span> <span class="s2">&quot;chromedriver&quot;</span><span class="p">)</span>
<span class="linenos"> 28</span>        <span class="c1"># Set the headless command to run Firefox without a graphical interface</span>
<span class="linenos"> 29</span>        <span class="n">options</span> <span class="o">=</span> <span class="n">Options</span><span class="p">()</span>
<span class="linenos"> 30</span>        <span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--headless&quot;</span><span class="p">)</span>
<span class="linenos"> 31</span>        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="n">Chrome</span><span class="p">(</span><span class="n">executable_path</span><span class="o">=</span><span class="n">executable</span><span class="p">,</span> <span class="n">chrome_options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
<span class="linenos"> 32</span>
<span class="linenos"> 33</span>    <span class="c1"># Define the &#39;start&#39; function that searches and returns all the links found in the web pages and returns them as strings</span>
<span class="linenos"> 34</span>    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="linenos"> 35</span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Main function to be run, go to the home page, find the list of cases,</span>
<span class="linenos"> 36</span><span class="sd">        then send a request to the scrape function to get the data from that page</span>
<span class="linenos"> 37</span>
<span class="linenos"> 38</span><span class="sd">        :return: list of links to scrap</span>
<span class="linenos"> 39</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 40</span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;loading main page&quot;</span><span class="p">)</span>
<span class="linenos"> 41</span>        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">home_url</span><span class="p">)</span>
<span class="linenos"> 42</span>
<span class="linenos"> 43</span>        <span class="n">main_pane</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s2">&quot;mainbox&quot;</span><span class="p">)</span>
<span class="linenos"> 44</span>        <span class="n">all_cases</span> <span class="o">=</span> <span class="n">main_pane</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span>
<span class="linenos"> 45</span>            <span class="n">By</span><span class="o">.</span><span class="n">TAG_NAME</span><span class="p">,</span> <span class="s2">&quot;li&quot;</span>
<span class="linenos"> 46</span>        <span class="p">)</span>  <span class="c1"># every case is under an LI tag</span>
<span class="linenos"> 47</span>        <span class="c1"># We&#39;ll load the href links into an array to get later</span>
<span class="linenos"> 48</span>        <span class="n">links</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos"> 49</span>        <span class="k">for</span> <span class="n">case</span> <span class="ow">in</span> <span class="n">all_cases</span><span class="p">:</span>
<span class="linenos"> 50</span>            <span class="n">a_tags</span> <span class="o">=</span> <span class="n">case</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">TAG_NAME</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span>
<span class="linenos"> 51</span>            <span class="c1"># The first a tag, is the link that we need</span>
<span class="linenos"> 52</span>            <span class="n">links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a_tags</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;href&quot;</span><span class="p">))</span>
<span class="linenos"> 53</span>        <span class="k">return</span> <span class="n">links</span>
<span class="linenos"> 54</span>
<span class="linenos"> 55</span>    <span class="c1"># Define the &#39;scrape_page&#39; function which, starting from the previously collected URLs, parses the content of each chatlog page and extracts the username, content (statement) and timestamp of each message</span>
<span class="linenos"> 56</span>    <span class="k">def</span> <span class="nf">scrape_page</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">page_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span class="linenos"> 57</span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Go to the page url, use the regular expression to extract the chatdata, store</span>
<span class="linenos"> 58</span><span class="sd">        this into a temporary pandas data frame to be returned once the page is complete.</span>
<span class="linenos"> 59</span>
<span class="linenos"> 60</span><span class="sd">        :param page_url: (str) the page to scrap</span>
<span class="linenos"> 61</span><span class="sd">        :return: pandas DataFrame of all chat instances on this page</span>
<span class="linenos"> 62</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos"> 63</span>        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">page_url</span><span class="p">)</span>
<span class="linenos"> 64</span>        <span class="k">try</span><span class="p">:</span>
<span class="linenos"> 65</span>            <span class="n">page_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">CLASS_NAME</span><span class="p">,</span> <span class="s2">&quot;chatLog&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
<span class="linenos"> 66</span>        <span class="k">except</span> <span class="n">NoSuchElementException</span><span class="p">:</span>
<span class="linenos"> 67</span>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;could not get convo for&quot;</span><span class="p">,</span> <span class="n">page_url</span><span class="p">)</span>
<span class="linenos"> 68</span>            <span class="k">return</span> <span class="p">[]</span>  <span class="c1"># Some pages don&#39;t contain chats</span>
<span class="linenos"> 69</span>        <span class="n">conversations</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos"> 70</span>
<span class="linenos"> 71</span>        <span class="c1"># Next, we&#39;ll run the regex on the chat-log and extract the info into a formatted pandas DF</span>
<span class="linenos"> 72</span>        <span class="n">matches</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chat_instance</span><span class="p">,</span> <span class="n">page_text</span><span class="p">)</span>
<span class="linenos"> 73</span>        <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
<span class="linenos"> 74</span>            <span class="c1"># Clean up false negatives</span>
<span class="linenos"> 75</span>            <span class="k">if</span> <span class="p">(</span>
<span class="linenos"> 76</span>                <span class="s2">&quot;com Conversation&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">match</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="linenos"> 77</span>                <span class="ow">and</span> <span class="s2">&quot;Text Messaging&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">match</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="linenos"> 78</span>                <span class="ow">and</span> <span class="s2">&quot;Yahoo Instant&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">match</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="linenos"> 79</span>            <span class="p">):</span>
<span class="linenos"> 80</span>                <span class="n">username</span> <span class="o">=</span> <span class="n">match</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="linenos"> 81</span>                <span class="k">if</span> <span class="n">match</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span>
<span class="linenos"> 82</span>                    <span class="n">statement</span> <span class="o">=</span> <span class="n">match</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="linenos"> 83</span>                    <span class="n">time</span> <span class="o">=</span> <span class="n">match</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
<span class="linenos"> 84</span>                <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 85</span>                    <span class="n">statement</span> <span class="o">=</span> <span class="n">match</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
<span class="linenos"> 86</span>                    <span class="n">time</span> <span class="o">=</span> <span class="n">match</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos"> 87</span>                <span class="n">conversations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<span class="linenos"> 88</span>                    <span class="p">{</span><span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="n">username</span><span class="p">,</span> <span class="s2">&quot;statement&quot;</span><span class="p">:</span> <span class="n">statement</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="n">time</span><span class="p">}</span>
<span class="linenos"> 89</span>                <span class="p">)</span>
<span class="linenos"> 90</span>        <span class="k">return</span> <span class="n">conversations</span>
<span class="linenos"> 91</span>
<span class="linenos"> 92</span>
<span class="linenos"> 93</span><span class="c1"># The functions above are executed and the collected data is saved to a CSV file and a JSON file</span>
<span class="linenos"> 94</span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<span class="linenos"> 95</span>    <span class="n">chatlogscrapper</span> <span class="o">=</span> <span class="n">ChatLogScraper</span><span class="p">()</span>
<span class="linenos"> 96</span>    <span class="n">conversations</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos"> 97</span>    <span class="n">links</span> <span class="o">=</span> <span class="n">chatlogscrapper</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="linenos"> 98</span>
<span class="linenos"> 99</span>    <span class="k">try</span><span class="p">:</span>
<span class="linenos">100</span>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">link</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">links</span><span class="p">):</span>
<span class="linenos">101</span>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;getting&quot;</span><span class="p">,</span> <span class="n">link</span><span class="p">)</span>
<span class="linenos">102</span>            <span class="n">conversations</span> <span class="o">+=</span> <span class="n">chatlogscrapper</span><span class="o">.</span><span class="n">scrape_page</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>
<span class="linenos">103</span>    <span class="k">finally</span><span class="p">:</span>
<span class="linenos">104</span>        <span class="n">conversations</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">conversations</span><span class="p">)</span>
<span class="linenos">105</span>        <span class="n">conversations</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;output.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="linenos">106</span>        <span class="n">conversations</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="s2">&quot;output.json&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="creating-the-final-corpus">
<span class="sidenote"><sup>4</sup><code class="docutils literal notranslate"><span class="pre">CATLISM,</span> <span class="pre">360-366</span></code></span><h2>Creating the final corpus<label for='sidenote-role-4' class='margin-toggle'><span id="id7">
<sup>4</sup></span>

</label><input type='checkbox' id='sidenote-role-4' name='sidenote-role-4' class='margin-toggle'><span class="sidenote d-n"><sup>4</sup><code class="docutils literal notranslate"><span class="pre">CATLISM,</span> <span class="pre">360-366</span></code></span><a class="headerlink" href="#creating-the-final-corpus" title="Permalink to this heading">#</a></h2>
<span class="sidenote"><sup>5</sup><code class="docutils literal notranslate"><span class="pre">CATLISM,</span> <span class="pre">360</span></code></span><blockquote>
<div><p>Script <code class="docutils literal notranslate"><span class="pre">[s6.06]</span></code> applies the steps described in sections ‘Emoticons’, ‘Duration and Turns’, and ‘Metadata’ to the collected CSV files and outputs an XML fle for each of them using the structure exemplified in <code class="docutils literal notranslate"><span class="pre">[e6.08]</span></code><label for='sidenote-role-5' class='margin-toggle'><span id="id8">
<sup>5</sup></span>

</label><input type='checkbox' id='sidenote-role-5' name='sidenote-role-5' class='margin-toggle'><span class="sidenote d-n"><sup>5</sup><code class="docutils literal notranslate"><span class="pre">CATLISM,</span> <span class="pre">360</span></code></span></p>
</div></blockquote>
<div class="literal-block-wrapper docutils container" id="s6-06">
<div class="code-block-caption"><span class="caption-text">Script <code class="docutils literal notranslate"><span class="pre">[s6.06]</span></code> <a class="reference external" href="https://github.com/catlism/catlism_scripts/raw/main/s6.06_chatlog_create_XML.py"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-download sd-text-primary" viewBox="0 0 16 16" aria-hidden="true"><path fill-rule="evenodd" d="M7.47 10.78a.75.75 0 001.06 0l3.75-3.75a.75.75 0 00-1.06-1.06L8.75 8.44V1.75a.75.75 0 00-1.5 0v6.69L4.78 5.97a.75.75 0 00-1.06 1.06l3.75 3.75zM3.75 13a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5z"></path></svg></a></span><a class="headerlink" href="#s6-06" title="Permalink to this code">#</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="c1"># Import (in order) the modules to: read/write CSV files; find files using regular expressions;</span>
<span class="linenos">  2</span><span class="c1"># work with regular expressions; generate random strings; to generate random numbers; randomise data;</span>
<span class="linenos">  3</span><span class="c1"># create dictionaries (the &#39;defaultdict&#39; has the ability to handle missing data in dictionaries,</span>
<span class="linenos">  4</span><span class="c1"># in contrast to Python&#39;s default dictionary); read/write XML files</span>
<span class="linenos">  5</span><span class="kn">import</span> <span class="nn">csv</span>
<span class="linenos">  6</span><span class="kn">import</span> <span class="nn">glob</span>
<span class="linenos">  7</span><span class="kn">import</span> <span class="nn">re</span>
<span class="linenos">  8</span><span class="kn">import</span> <span class="nn">string</span>
<span class="linenos">  9</span><span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randint</span>
<span class="linenos"> 10</span><span class="kn">import</span> <span class="nn">random</span>
<span class="linenos"> 11</span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="linenos"> 12</span><span class="kn">from</span> <span class="nn">lxml</span> <span class="kn">import</span> <span class="n">etree</span>
<span class="linenos"> 13</span>
<span class="linenos"> 14</span><span class="c1"># List all CSV files in the current folder</span>
<span class="linenos"> 15</span><span class="n">csvfiles</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*.csv&quot;</span><span class="p">)</span>
<span class="linenos"> 16</span>
<span class="linenos"> 17</span><span class="c1"># Create two dictionaries: one (&#39;user_types_dict&#39;) to store usernames mapped against their &#39;role&#39; (g = groomer, d = decoy);</span>
<span class="linenos"> 18</span><span class="c1"># the other (&#39;timings_dict&#39;) to store usernames mapped against the total amount of time it interacted with one or more decoys</span>
<span class="linenos"> 19</span><span class="n">user_types_dict</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span class="linenos"> 20</span><span class="n">timings_dict</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span class="linenos"> 21</span>
<span class="linenos"> 22</span><span class="c1"># Open the metadata file (named .cs to avoid being read as a CSV chat log file) and read it as a csv file</span>
<span class="linenos"> 23</span><span class="n">metadata_file</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span>
<span class="linenos"> 24</span>    <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;metadata_file.cs&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
<span class="linenos"> 25</span><span class="p">)</span>
<span class="linenos"> 26</span><span class="c1"># For each row, do:</span>
<span class="linenos"> 27</span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">metadata_file</span><span class="p">:</span>
<span class="linenos"> 28</span>    <span class="c1"># Read the username and its role and add the information to the dictionary &#39;user_types_dict&#39;</span>
<span class="linenos"> 29</span>    <span class="n">user_types_dict</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="linenos"> 30</span>    <span class="c1"># Read the total amount of time a groomer interacted with a decoy, and assign the value to the dictionary &#39;timings_dict&#39;</span>
<span class="linenos"> 31</span>    <span class="n">timings_dict</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="linenos"> 32</span>
<span class="linenos"> 33</span>
<span class="linenos"> 34</span><span class="c1"># Create a function to add the type (g or d) to the username passed to the function during the data processing</span>
<span class="linenos"> 35</span><span class="k">def</span> <span class="nf">get_user_type</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
<span class="linenos"> 36</span>    <span class="c1"># Read the username, convert it to lowercase, and store it in the variable &#39;user&#39;</span>
<span class="linenos"> 37</span>    <span class="n">user</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="linenos"> 38</span>    <span class="c1"># If &#39;user&#39; is found in &#39;user_types_dict&#39;, extract its type label and store it in the variable &#39;usertype&#39;</span>
<span class="linenos"> 39</span>    <span class="k">if</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">user_types_dict</span><span class="p">:</span>
<span class="linenos"> 40</span>        <span class="n">usertype</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">user_types_dict</span><span class="p">[</span><span class="n">user</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="linenos"> 41</span>    <span class="c1"># Else if not found, assign the value &#39;na&#39; to the variable &#39;usertype&#39;</span>
<span class="linenos"> 42</span>    <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 43</span>        <span class="n">usertype</span> <span class="o">=</span> <span class="s2">&quot;na&quot;</span>
<span class="linenos"> 44</span>    <span class="c1"># Output the value of &#39;usertype&#39;</span>
<span class="linenos"> 45</span>    <span class="k">return</span> <span class="n">usertype</span>
<span class="linenos"> 46</span>
<span class="linenos"> 47</span>
<span class="linenos"> 48</span><span class="c1"># Create a function to add the total time of interaction to the corpus during the data processing, using the same rationale and</span>
<span class="linenos"> 49</span><span class="c1"># operations employed in &#39;get_user_type&#39;</span>
<span class="linenos"> 50</span><span class="k">def</span> <span class="nf">get_user_timing</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
<span class="linenos"> 51</span>    <span class="n">username</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="linenos"> 52</span>    <span class="k">if</span> <span class="n">username</span> <span class="ow">in</span> <span class="n">timings_dict</span><span class="p">:</span>
<span class="linenos"> 53</span>        <span class="n">timing</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timings_dict</span><span class="p">[</span><span class="n">username</span><span class="p">])</span>
<span class="linenos"> 54</span>    <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 55</span>        <span class="n">timing</span> <span class="o">=</span> <span class="s2">&quot;na&quot;</span>
<span class="linenos"> 56</span>    <span class="k">return</span> <span class="n">timing</span>
<span class="linenos"> 57</span>
<span class="linenos"> 58</span>
<span class="linenos"> 59</span><span class="c1"># Build the emoticons conversion steps; adapted from the emoticons.py function by Brendan O&#39;Connor</span>
<span class="linenos"> 60</span><span class="c1"># https://github.com/aritter/twitter_nlp/blob/65f3d77134c40d920db8d431c5c6faef1c051c94/python/emoticons.py</span>
<span class="linenos"> 61</span><span class="c1"># Define the regular expression that will be used during the data processing to identify emoticons</span>
<span class="linenos"> 62</span><span class="n">regex_compile</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">pat</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">pat</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">UNICODE</span><span class="p">)</span>
<span class="linenos"> 63</span><span class="c1"># Define the characters for eyes, nose, mouth to be used in the regular expressions; each</span>
<span class="linenos"> 64</span><span class="n">NormalEyes</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;[:=]&quot;</span>
<span class="linenos"> 65</span><span class="n">Wink</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;[;]&quot;</span>
<span class="linenos"> 66</span><span class="n">NoseArea</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;(|o|O|-)&quot;</span>
<span class="linenos"> 67</span><span class="n">HappyMouths</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;[D\)\]]&quot;</span>
<span class="linenos"> 68</span><span class="n">SadMouths</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;[\(\[]&quot;</span>
<span class="linenos"> 69</span><span class="n">KissMouths</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;[\*]&quot;</span>
<span class="linenos"> 70</span><span class="n">Tongue</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;[pP]&quot;</span>
<span class="linenos"> 71</span>
<span class="linenos"> 72</span><span class="c1"># Construct the possible combinations into regular expressions</span>
<span class="linenos"> 73</span><span class="n">happysmiley_regex</span> <span class="o">=</span> <span class="p">(</span>
<span class="linenos"> 74</span>    <span class="s2">&quot;(&quot;</span>
<span class="linenos"> 75</span>    <span class="o">+</span> <span class="n">NormalEyes</span>
<span class="linenos"> 76</span>    <span class="o">+</span> <span class="s2">&quot;|&quot;</span>
<span class="linenos"> 77</span>    <span class="o">+</span> <span class="n">Wink</span>
<span class="linenos"> 78</span>    <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
<span class="linenos"> 79</span>    <span class="o">+</span> <span class="n">NoseArea</span>
<span class="linenos"> 80</span>    <span class="o">+</span> <span class="s2">&quot;(&quot;</span>
<span class="linenos"> 81</span>    <span class="o">+</span> <span class="n">HappyMouths</span>
<span class="linenos"> 82</span>    <span class="o">+</span> <span class="s2">&quot;|&quot;</span>
<span class="linenos"> 83</span>    <span class="o">+</span> <span class="n">Tongue</span>
<span class="linenos"> 84</span>    <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
<span class="linenos"> 85</span><span class="p">)</span>
<span class="linenos"> 86</span><span class="n">sadsmiley_regex</span> <span class="o">=</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">NormalEyes</span> <span class="o">+</span> <span class="s2">&quot;|&quot;</span> <span class="o">+</span> <span class="n">Wink</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span> <span class="o">+</span> <span class="n">NoseArea</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">SadMouths</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
<span class="linenos"> 87</span><span class="n">kisssmiley_regex</span> <span class="o">=</span> <span class="p">(</span>
<span class="linenos"> 88</span>    <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">NormalEyes</span> <span class="o">+</span> <span class="s2">&quot;|&quot;</span> <span class="o">+</span> <span class="n">Wink</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span> <span class="o">+</span> <span class="n">NoseArea</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">KissMouths</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
<span class="linenos"> 89</span><span class="p">)</span>
<span class="linenos"> 90</span><span class="c1"># Compile the regular expressions using the previously defined &#39;regex_compile&#39;</span>
<span class="linenos"> 91</span><span class="n">happysmiley_compile</span> <span class="o">=</span> <span class="n">regex_compile</span><span class="p">(</span><span class="n">happysmiley_regex</span><span class="p">)</span>
<span class="linenos"> 92</span><span class="n">sadsmiley_compile</span> <span class="o">=</span> <span class="n">regex_compile</span><span class="p">(</span><span class="n">sadsmiley_regex</span><span class="p">)</span>
<span class="linenos"> 93</span><span class="n">kisssmiley_compile</span> <span class="o">=</span> <span class="n">regex_compile</span><span class="p">(</span><span class="n">kisssmiley_regex</span><span class="p">)</span>
<span class="linenos"> 94</span>
<span class="linenos"> 95</span><span class="c1"># Define the root &lt;corpus&gt; XML element tag of the output file</span>
<span class="linenos"> 96</span><span class="n">corpus</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s2">&quot;corpus&quot;</span><span class="p">)</span>
<span class="linenos"> 97</span>
<span class="linenos"> 98</span><span class="c1"># For each CSV chat log file, do:</span>
<span class="linenos"> 99</span><span class="k">for</span> <span class="n">csvfile</span> <span class="ow">in</span> <span class="n">csvfiles</span><span class="p">:</span>
<span class="linenos">100</span>    <span class="c1"># Create the &lt;text&gt; root element tag as child of the &lt;corpus&gt; root element</span>
<span class="linenos">101</span>    <span class="n">text_tag</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">corpus</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">)</span>
<span class="linenos">102</span>
<span class="linenos">103</span>    <span class="c1"># Create a function to generate a random ID using the &#39;random_number&#39; variable (defined further below), plus a</span>
<span class="linenos">104</span>    <span class="c1"># set of randomly chosen letters</span>
<span class="linenos">105</span>    <span class="k">def</span> <span class="nf">id_generator</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
<span class="linenos">106</span>        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
<span class="linenos">107</span>            <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span>
<span class="linenos">108</span>                <span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">N</span>
<span class="linenos">109</span>            <span class="p">)</span>
<span class="linenos">110</span>        <span class="p">)</span>
<span class="linenos">111</span>
<span class="linenos">112</span>    <span class="c1"># Generate a random number to be used for the creation of the unique &lt;text&gt; ID</span>
<span class="linenos">113</span>    <span class="n">random_number</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100000000</span><span class="p">))</span>
<span class="linenos">114</span>    <span class="c1"># Generate a random ID and assign it as value of the &lt;text&gt; attribute &#39;id&#39;</span>
<span class="linenos">115</span>    <span class="n">text_tag</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">id_generator</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="n">random_number</span><span class="p">)</span>
<span class="linenos">116</span>
<span class="linenos">117</span>    <span class="c1"># Create an empty list to store the usernames found in the chat log</span>
<span class="linenos">118</span>    <span class="n">usernames_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos">119</span>
<span class="linenos">120</span>    <span class="c1"># Open the chat log file and read it as a csv file</span>
<span class="linenos">121</span>    <span class="n">input_csv</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">csvfile</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>
<span class="linenos">122</span>    <span class="c1"># Store the filename without extension inside the variable &#39;filename_without_csv&#39;</span>
<span class="linenos">123</span>    <span class="n">filename_without_csv</span> <span class="o">=</span> <span class="n">csvfile</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="linenos">124</span>    <span class="c1"># Skip the first line of the CSV chat log file containing the columns header</span>
<span class="linenos">125</span>    <span class="nb">next</span><span class="p">(</span><span class="n">input_csv</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="linenos">126</span>    <span class="c1"># Iterate over each row and store them inside of the variable &#39;rows&#39;</span>
<span class="linenos">127</span>    <span class="n">rows</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">input_csv</span><span class="p">]</span>
<span class="linenos">128</span>    <span class="c1"># For each row, count its position (starting from 1; this is equal to the turn number in the chat) and store it in</span>
<span class="linenos">129</span>    <span class="c1"># the variable &#39;line_number&#39;, then do:</span>
<span class="linenos">130</span>    <span class="k">for</span> <span class="n">line_number</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="linenos">131</span>        <span class="c1"># Create the &lt;u&gt; element tag for the chat turn (i.e. the chat message)</span>
<span class="linenos">132</span>        <span class="n">turn_tag</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">text_tag</span><span class="p">,</span> <span class="s2">&quot;u&quot;</span><span class="p">)</span>
<span class="linenos">133</span>        <span class="c1"># Assign the row position in the csv file as value of the &lt;u&gt; attribute &#39;turn&#39;</span>
<span class="linenos">134</span>        <span class="n">turn_tag</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s2">&quot;turn&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">line_number</span><span class="p">)</span>
<span class="linenos">135</span>        <span class="c1"># Read the username from the first column of the chat log file, clean it from any potential leading or trailing whitespace,</span>
<span class="linenos">136</span>        <span class="c1"># and assign it as value of the &lt;u&gt; attribute &#39;username&#39;</span>
<span class="linenos">137</span>        <span class="n">turn_tag</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s2">&quot;username&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="linenos">138</span>        <span class="c1"># Write the username (without any potential whitespace) to the list of usernames for this chat log</span>
<span class="linenos">139</span>        <span class="n">usernames_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
<span class="linenos">140</span>        <span class="c1"># Read the timestamp from the third column of the chat log file and assign it as value of the &lt;u&gt; attribute &#39;time&#39;</span>
<span class="linenos">141</span>        <span class="n">turn_tag</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="linenos">142</span>        <span class="c1"># Read the date on which the message was sent from the fourth column of the chat log file, and assign it as value of</span>
<span class="linenos">143</span>        <span class="c1"># the &lt;u&gt; attribute &#39;date&#39;</span>
<span class="linenos">144</span>        <span class="n">turn_tag</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="linenos">145</span>        <span class="c1"># Using the &#39;get_user_type&#39; function with the username as input, extract the type of user and assign it as value of the</span>
<span class="linenos">146</span>        <span class="c1"># &lt;u&gt; attribute &#39;usertype&#39;</span>
<span class="linenos">147</span>        <span class="n">turn_tag</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s2">&quot;usertype&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_user_type</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
<span class="linenos">148</span>        <span class="c1"># Read the chat message from the second column of the chat log file and store it inside a variable</span>
<span class="linenos">149</span>        <span class="n">message</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos">150</span>        <span class="c1"># Test for the presence of emoticons in the message using the three previously compiled regular expressions, and if found substitute it with the respective substitution-label (§_HAPPY-SMILEY_§, §_SAD-SMILEY_§, or §_KISS-SMILEY_§)</span>
<span class="linenos">151</span>        <span class="k">if</span> <span class="n">happysmiley_compile</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">message</span><span class="p">):</span>
<span class="linenos">152</span>            <span class="n">message</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">happysmiley_compile</span><span class="p">,</span> <span class="s2">&quot; §HAPPY-SMILEY§ &quot;</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
<span class="linenos">153</span>        <span class="k">elif</span> <span class="n">sadsmiley_compile</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">message</span><span class="p">):</span>
<span class="linenos">154</span>            <span class="n">message</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">sadsmiley_compile</span><span class="p">,</span> <span class="s2">&quot; §SAD-SMILEY§ &quot;</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
<span class="linenos">155</span>        <span class="k">elif</span> <span class="n">kisssmiley_compile</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">message</span><span class="p">):</span>
<span class="linenos">156</span>            <span class="n">message</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">kisssmiley_compile</span><span class="p">,</span> <span class="s2">&quot; §KISS-SMILEY§ &quot;</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
<span class="linenos">157</span>        <span class="c1"># Assign the formatted message as text of the &lt;u&gt; element tag</span>
<span class="linenos">158</span>        <span class="n">turn_tag</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">message</span>
<span class="linenos">159</span>
<span class="linenos">160</span>    <span class="c1"># Read all the unique values in the list of usernames, and for each one do:</span>
<span class="linenos">161</span>    <span class="k">for</span> <span class="n">username</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">usernames_list</span><span class="p">):</span>
<span class="linenos">162</span>        <span class="c1"># Get the user type</span>
<span class="linenos">163</span>        <span class="n">user_type</span> <span class="o">=</span> <span class="n">get_user_type</span><span class="p">(</span><span class="n">username</span><span class="p">)</span>
<span class="linenos">164</span>        <span class="c1"># If the user type is equal to &#39;g&#39; (i.e. groomer), get the total amount of time they spent chatting and assign it to</span>
<span class="linenos">165</span>        <span class="c1"># the &lt;text&gt; attribute &#39;timing&#39;, and add the groomer&#39;s username as value of the &lt;text&gt; attribute &#39;user&#39;</span>
<span class="linenos">166</span>        <span class="k">if</span> <span class="n">user_type</span> <span class="o">==</span> <span class="s2">&quot;g&quot;</span><span class="p">:</span>
<span class="linenos">167</span>            <span class="n">text_tag</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s2">&quot;timing&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span>
<span class="linenos">168</span>                <span class="s2">&quot;(\[|\]|&#39;)&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">get_user_timing</span><span class="p">(</span><span class="n">username</span><span class="p">)</span>
<span class="linenos">169</span>            <span class="p">)</span>
<span class="linenos">170</span>            <span class="n">text_tag</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s2">&quot;user&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">username</span>
<span class="linenos">171</span>
<span class="linenos">172</span><span class="c1"># Create the XML structure by adding all the extracted elements to the main &#39;corpus&#39; tag</span>
<span class="linenos">173</span><span class="n">tree</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span>
<span class="linenos">174</span><span class="c1"># The resulting XML structure is written to the XML file named after the original CSV chat log file using utf-8 encoding,</span>
<span class="linenos">175</span><span class="c1"># adding the XML declaration at the beginning and graphically formatting the layout (&#39;pretty_print&#39;)</span>
<span class="linenos">176</span><span class="n">tree</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
<span class="linenos">177</span>    <span class="n">filename_without_csv</span> <span class="o">+</span> <span class="s2">&quot;.xml&quot;</span><span class="p">,</span>
<span class="linenos">178</span>    <span class="n">pretty_print</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos">179</span>    <span class="n">xml_declaration</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos">180</span>    <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span>
<span class="linenos">181</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="sample-from-the-final-corpus">
<span class="sidenote"><sup>6</sup><code class="docutils literal notranslate"><span class="pre">CATLISM,</span> <span class="pre">352-353</span></code></span><h2>Sample from the final corpus<label for='sidenote-role-6' class='margin-toggle'><span id="id9">
<sup>6</sup></span>

</label><input type='checkbox' id='sidenote-role-6' name='sidenote-role-6' class='margin-toggle'><span class="sidenote d-n"><sup>6</sup><code class="docutils literal notranslate"><span class="pre">CATLISM,</span> <span class="pre">352-353</span></code></span><a class="headerlink" href="#sample-from-the-final-corpus" title="Permalink to this heading">#</a></h2>
<div class="literal-block-wrapper docutils container" id="e6-08">
<div class="code-block-caption"><span class="caption-text">Example <code class="docutils literal notranslate"><span class="pre">[e6.08]</span></code></span><a class="headerlink" href="#e6-08" title="Permalink to this code">#</a></div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">&lt;?xml version=&#39;1.0&#39; encoding=&#39;UTF-8&#39;?&gt;</span>
<span class="linenos"> 2</span><span class="nt">&lt;corpus&gt;</span>
<span class="linenos"> 3</span><span class="w">    </span><span class="nt">&lt;text</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;dz1cVUMyIB99080150&quot;</span><span class="w"> </span><span class="na">timing=</span><span class="s">&quot;1333&quot;</span><span class="w"> </span><span class="na">user=</span><span class="s">&quot;luv2licku68&quot;</span><span class="nt">&gt;</span>
<span class="linenos"> 4</span><span class="w">        </span><span class="nt">&lt;u</span><span class="w"> </span><span class="na">turn=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">username=</span><span class="s">&quot;luv2licku68&quot;</span><span class="w"> </span><span class="na">time=</span><span class="s">&quot;8:54:50 PM&quot;</span><span class="w"> </span><span class="na">date=</span><span class="s">&quot;04112010&quot;</span><span class="w"> </span><span class="na">usertype=</span><span class="s">&quot;g&quot;</span><span class="nt">&gt;</span><span class="w"> </span>hey<span class="w"> </span>there,<span class="w"> </span>how<span class="w"> </span>are<span class="w"> </span>you<span class="w"> </span>doing?<span class="nt">&lt;/u&gt;</span>
<span class="linenos"> 5</span><span class="w">        </span><span class="nt">&lt;u</span><span class="w"> </span><span class="na">turn=</span><span class="s">&quot;2&quot;</span><span class="w"> </span><span class="na">username=</span><span class="s">&quot;katierella1013&quot;</span><span class="w"> </span><span class="na">time=</span><span class="s">&quot;8:54:01 PM&quot;</span><span class="w"> </span><span class="na">date=</span><span class="s">&quot;04112010&quot;</span><span class="w"> </span><span class="na">usertype=</span><span class="s">&quot;d&quot;</span><span class="nt">&gt;</span><span class="w"> </span>hi<span class="w"> </span>a/s/l?<span class="w">  </span>§_HAPPY-SMILEY_§<span class="w"> </span><span class="nt">&lt;/u&gt;</span>
<span class="linenos"> 6</span><span class="w">        </span>...
<span class="linenos"> 7</span><span class="w">        </span><span class="nt">&lt;u</span><span class="w"> </span><span class="na">turn=</span><span class="s">&quot;19&quot;</span><span class="w"> </span><span class="na">username=</span><span class="s">&quot;katierella1013&quot;</span><span class="w"> </span><span class="na">time=</span><span class="s">&quot;8:59:13 PM&quot;</span><span class="w"> </span><span class="na">date=</span><span class="s">&quot;04112010&quot;</span><span class="w"> </span><span class="na">usertype=</span><span class="s">&quot;d&quot;</span><span class="nt">&gt;</span>
<span class="linenos"> 8</span><span class="w">            </span>well<span class="w"> </span>i
<span class="linenos"> 9</span><span class="w">            </span><span class="nt">&lt;normalised</span><span class="w"> </span><span class="na">orig=</span><span class="s">&quot;dunno&quot;</span><span class="w"> </span><span class="na">auto=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>don&#39;t<span class="w"> </span>know<span class="nt">&lt;/normalised&gt;</span>
<span class="linenos">10</span><span class="w">            </span>,<span class="w"> </span>like<span class="w"> </span>the<span class="w"> </span>stuff<span class="w"> </span>some<span class="w"> </span>people<span class="w"> </span>say<span class="w"> </span>and<span class="w"> </span>there&#39;s<span class="w"> </span>like<span class="w"> </span>so<span class="w"> </span>much<span class="w"> </span>going<span class="w"> </span>on,<span class="w"> </span>so<span class="w"> </span>many<span class="w"> </span>conversations
<span class="linenos">11</span><span class="w">            </span><span class="nt">&lt;normalised</span><span class="w"> </span><span class="na">orig=</span><span class="s">&quot;n&quot;</span><span class="w"> </span><span class="na">auto=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>and<span class="nt">&lt;/normalised&gt;</span>
<span class="linenos">12</span><span class="w">            </span>stuff
<span class="linenos">13</span><span class="w">        </span><span class="nt">&lt;/u&gt;</span>
<span class="linenos">14</span><span class="w">    </span><span class="nt">&lt;/text&gt;</span>
<span class="linenos">15</span><span class="w">    </span>...
<span class="linenos">16</span><span class="nt">&lt;/corpus&gt;</span>
</pre></div>
</div>
</div>
</section>
<section id="example-of-the-interactive-plot-created-for-the-visual-exploration-of-collocations">
<span class="sidenote"><sup>7</sup><code class="docutils literal notranslate"><span class="pre">CATLISM,</span> <span class="pre">368</span></code></span><h2>Example of the interactive plot created for the visual exploration of collocations<label for='sidenote-role-7' class='margin-toggle'><span id="id10">
<sup>7</sup></span>

</label><input type='checkbox' id='sidenote-role-7' name='sidenote-role-7' class='margin-toggle'><span class="sidenote d-n"><sup>7</sup><code class="docutils literal notranslate"><span class="pre">CATLISM,</span> <span class="pre">368</span></code></span><a class="headerlink" href="#example-of-the-interactive-plot-created-for-the-visual-exploration-of-collocations" title="Permalink to this heading">#</a></h2>
<figure class="figure align-default" id="fig6-3">
<a class="bg-primary mb-1 reference internal image-reference" href="../../_images/Figure6.3.jpg"><img alt="Figure 6.3 Example of the interactive plot created for the visual exploration of collocations" class="bg-primary mb-1" src="../../_images/Figure6.3.jpg" style="width: 400px;" /></a>
<figcaption>
<p><span class="caption-text"><em>Figure 6.3</em> Example of the interactive plot created for the visual exploration of collocations</span><a class="headerlink" href="#fig6-3" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p><span class="sd-d-grid"><a class="sd-sphinx-override sd-btn sd-text-wrap sd-btn-primary reference external" href="https://mdic.github.io/og_plot/"><span>Consult the original interactive plot</span></a></span></p>
<hr class="footnotes docutils" />
</section>
</section>


                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../frg/index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Analysing the language of far-right groups on Twitter and Facebook</p>
      </div>
    </a>
    <a class="right-next"
       href="../../faq.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="fa fa-circle-question"></span> FAQs</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#collecting-the-data-from-perverted-justice">Collecting the data from Perverted Justice</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-the-final-corpus">Creating the final corpus</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-from-the-final-corpus">Sample from the final corpus</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-of-the-interactive-plot-created-for-the-visual-exploration-of-collocations">Example of the interactive plot created for the visual exploration of collocations</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Matteo Di Cristofaro
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023, Matteo Di Cristofaro.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <div>Built with <a href='https://github.com/executablebooks/sphinx-book-theme'>Sphinx book theme</a></div><div><a href='https://catlism.github.io/privacy.html'>Privacy</a></div>
</div>
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>


  <footer class="bd-footer">
  </footer>
<script async src="https://analytics.umami.is/script.js" data-website-id="c69c4e7a-b900-47c2-bab5-a154909a8bc5"></script>

  </body>
</html>